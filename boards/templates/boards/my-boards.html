{% extends 'base.html' %}
{% load static %}
{% block profile %}
<link rel="stylesheet" href="{% static 'styles/my-boards.css' %}" />
{% endblock %}

{% block content %}
<main>
    <div class="boards">
        <h2>–ú–æ–∏ –¥–æ—Å–∫–∏</h2>
        {% for board in boards %}
        <div class="board-container" data-board-id="{{ board.id }}" data-board-owner-id="{{ board.owner.id }}">

            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –¥–æ—Å–∫–∏ - —Ç–µ–ø–µ—Ä—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –±–ª–æ–∫ -->
            <a href="{% url 'boards-page' board.id %}" class="board-title"
                style="{% if request.user != board.owner %}background-color: #8d8d8d{% endif %}">
                {{board.title}}
            </a>

            <!-- –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ -->
            <div class="super-ultra-content">
                <div class="board-supercontent">
                    <div class="board-content">
                        <div class="{% if request.user != board.owner %}hidden{% endif %} member-add">
                            <form method="post" class="email-compose" data-board-id="{{ board.id }}"
                                data-search-url="{% url 'search-users-for-board' %}"
                                action="{% url 'add-board-member' board.id %}">
                                {% csrf_token %}
                                <label for="recipient-{{ board.id }}">–ü–æ–∏—Å–∫:</label>
                                <input type="text" id="recipient-{{ board.id }}" autocomplete="off"
                                    placeholder="–ù–∞—á–Ω–∏—Ç–µ –≤–≤–æ–¥–∏—Ç—å –∏–º—è..." required />
                                <input type="hidden" name="recipient_id" id="recipient_id-{{ board.id }}" />
                                <div id="suggestions-{{ board.id }}" class="suggestions"></div>
                                <label for="role-{{ board.id }}">–†–æ–ª—å:</label>
                                <select name="role" id="role-{{ board.id }}" required>
                                    <option value="member">–£—á–∞—Å—Ç–Ω–∏–∫</option>
                                    <option value="viewer">–¢–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä</option>
                                    <option value="owner">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</option>
                                </select>
                                <button type="submit" class="btn compose">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                            </form>
                        </div>

                        <button type="button" class="toggle-users" data-board-id="{{ board.id }}"
                            data-current-user-id="{{ request.user.id }}">
                            –£—á–∞—Å—Ç–Ω–∏–∫–∏ <span class="arrow">‚ñº</span>
                        </button>

                        <div class="list-of-board-users" id="users-{{ board.id }}" hidden></div>

                    </div>
                    <div class="board-created">{{ board.created }}</div>
                </div>

            </div>
            <!-- –ö–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞ (–¥–ª—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∏ –∑—Ä–∏—Ç–µ–ª–µ–π, –Ω–æ –Ω–µ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞) -->
            {% if request.user != board.owner %}
            <div class="permit">
                <form method="post" action="{% url 'exit_board' board.id %}" style="display: inline"
                    class="exit-board-form">
                    {% csrf_token %}
                    <button type="submit" class="exit-board">–í—ã–π—Ç–∏</button>
                </form>
            </div>
            {% endif %}
            <!-- –ö–Ω–æ–ø–∫–∞ –∞—Ä—Ö–∏–≤–∞/—Ä–∞–∑–∞—Ä—Ö–∏–≤–∞—Ü–∏–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞) -->
            <div class="permit {% if request.user != board.owner %}hidden{% endif %}">
                <form method="post" action="{% url 'archive_board' board.id %}" style="display: inline"
                    class="archive-board-form">
                    {% csrf_token %}
                    <button type="submit" class="archive-board">
                        {% if board.is_archived %}
                        üì§ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –∞—Ä—Ö–∏–≤–∞
                        {% else %}
                         <img class="archive-img" src="/static/images/rar.svg" alt="–ê—Ä—Ö–∏–≤" style="width: 36px; height: 36px;">
                        {% endif %}
                    </button>
                </form>
            </div>
            <!-- –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞) -->
            <div class="permit {% if request.user != board.owner %}hidden{% endif %}">
                <form method="post" action="{% url 'delete_board' board.id %}" style="display: inline"
                    class="delete-board-form">
                    {% csrf_token %}
                    <button type="submit" class="delete-board">x</button>
                </form>
            </div>
        </div>
        {% endfor %}
    </div>
</main>

<!-- –î–æ–±–∞–≤–ª—è–µ–º CSRF —Ç–æ–∫–µ–Ω –≤ DOM –¥–ª—è JS —Ñ–∞–π–ª–∞ -->
<input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">

<script src="{% static 'js/my-boards.js' %}"></script>
{% endblock %}