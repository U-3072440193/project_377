{% extends 'base.html' %}
{% load static %}

{% block profile %}
<link rel="stylesheet" href="{% static 'styles/my-boards.css' %}" />
{% endblock %}

{% block content %}
<main>
    <div class="boards">
        <div class="archive-title">
            <img class="archive-img" src="/static/images/rar.svg" alt="Архив" style="width: 50px; height: 50px;">
            <h2>Архивные доски</h2>
        </div>


        {% if not archived_boards %}
        <div class="empty-archive">
            <p>В архиве пока нет досок</p>
            <a href="{% url 'my-boards' %}">Вернуться к активным доскам</a>
        </div>
        {% endif %}

        {% for board in archived_boards %}
        <div class="board-container" data-board-id="{{ board.id }}" data-board-owner-id="{{ board.owner.id }}">

            <!-- Заголовок доски -->
            <a href="{% url 'boards-page' board.id %}" class="board-title" style="background-color: #8d8d8d">
                {{board.title}}
                <span class="archive-badge">(В архиве)</span>
            </a>

            <!-- Основное содержимое -->
            <div class="super-ultra-content">
                <div class="board-supercontent">
                    <div class="board-content">
                        <!-- Для архивных досок скрываем формы добавления участников -->
                        <div class="archive-notice">
                            Доска находится в архиве (только для просмотра)
                        </div>

                        <button type="button" class="toggle-users" data-board-id="{{ board.id }}"
                            data-current-user-id="{{ request.user.id }}">
                            Участники <span class="arrow">▼</span>
                        </button>

                        <div class="list-of-board-users" id="users-{{ board.id }}" hidden></div>

                    </div>
                    <div class="board-created">
                        Архивирована: {{board.created|date:"d.m.Y"}}
                    </div>
                </div>
            </div>

            <!-- Кнопка восстановления из архива (только для владельца) -->
            <div class="permit {% if request.user != board.owner %}hidden{% endif %}">
                <form method="post" action="{% url 'archive_board' board.id %}" style="display: inline"
                    class="archive-board-form">
                    {% csrf_token %}
                    <button type="submit" class="archive-board">
                        <img src="{% static 'images/rerar.svg' %}" alt="Восстановить">
                    </button>
                </form>
            </div>

        </div>
        {% endfor %}
    </div>
</main>

<!-- Добавляем CSRF токен в DOM для JS файла -->
<input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">

<script src="{% static 'js/my-boards.js' %}"></script>
{% endblock %}